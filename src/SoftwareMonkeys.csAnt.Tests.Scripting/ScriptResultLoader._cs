using System;
using System.IO;
using System.Xml.Serialization;

namespace SoftwareMonkeys.csAnt.Tests.Scripting
{
	public class ScriptResultLoader
	{
        public IScript Script { get;set; }

		public ScriptResultLoader (
			IScript script
		)
		{
			Script = script;
		}

		public ScriptResult Load(
			string xmlResultFile
		)
		{
			ScriptResult result = null;

			using (var streamReader = File.OpenRead(xmlResultFile))
			{
				var xmlSerializer = new XmlSerializer(typeof(ScriptResult));

				result = (ScriptResult)xmlSerializer.Deserialize(streamReader);
			}

			return result;
		}
	}
}

